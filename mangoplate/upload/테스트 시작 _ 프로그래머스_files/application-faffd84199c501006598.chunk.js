(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1267:function(t,e,s){"use strict";s.r(e);var n=s(419),a=s(700);const i=n.a.start(),c=s(904);i.load(Object(a.a)(c)),s(902),console.log("Application.js")},524:function(t,e,s){"use strict";var n=s(685);e.a=Object(n.createConsumer)()},902:function(t,e,s){const n=s(903);n.keys().forEach(n)},903:function(t,e){function s(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}s.keys=function(){return[]},s.resolve=s,t.exports=s,s.id=903},904:function(t,e,s){var n={"./chat_controller.js":905,"./chat_notification_proctor_controller.js":906,"./chat_notification_testee_controller.js":907,"./chat_room_controller.js":908,"./essay_submission_controller.js":909,"./inquiries_controller.js":910};function a(t){var e=i(t);return s(e)}function i(t){if(!s.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}a.keys=function(){return Object.keys(n)},a.resolve=i,t.exports=a,a.id=904},905:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return o}));var n=s(88),a=s.n(n),i=s(419),c=s(524);class o extends i.b{connect(){console.log("chat channel connect ".concat(this.data.get("test-token-id"))),this.channel=c.a.subscriptions.create({channel:"ChatChannel",id:this.data.get("test-token-id")},{connected:this.connected.bind(this),received:this.received.bind(this)}),this.disableSubmitIfEmpty(),this.removeChatOthersClassForMyMessage()}disconnect(){console.log("chat channel DISCONNECT ".concat(this.data.get("test-token-id"))),this.channel.unsubscribe()}received(t){$(this.ulTarget).append(t.html),this.hasHelpMessageTarget&&$(this.helpMessageTarget).remove(),this.removeChatOthersClassForMyMessage(),this.channel.perform("mark",{test_token_id:this.data.get("test-token-id"),message_id:t.message.id,user_type:this.data.get("user-type")})}connected(){this.channel.perform("mark",{test_token_id:this.data.get("test-token-id"),message_id:$(this.ulTarget).find("li:last-of-type").data("message-id"),user_type:this.data.get("user-type")})}removeChatOthersClassForMyMessage(){$(this.ulTarget).find("li[data-userable='".concat(this.data.get("userable"),"']")).removeClass("chat-other-party"),$(this.ulTarget).scrollTop($(this.ulTarget)[0].scrollHeight)}disableSubmitIfEmpty(){$(this.formTarget).find("button[type=submit]").attr("disabled",!0),$(this.formTarget).find("#chat_message_message").keyup(function(t){""==$(t.target).val().trim()?$(this.formTarget).find("button[type=submit]").attr("disabled",!0):$(this.formTarget).find("button[type=submit]").attr("disabled",!1)}.bind(this))}}a()(o,"targets",["ul","form","helpMessage"])},906:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return o}));var n=s(88),a=s.n(n),i=s(419),c=s(524);class o extends i.b{connect(){this.channel=c.a.subscriptions.create({channel:"ChatNotificationProctorChannel",test:this.data.get("test-id"),user:this.data.get("user")},{connected:this.connected.bind(this),received:this.received.bind(this)})}disconnect(){this.channel.unsubscribe()}received(t){this.element.querySelectorAll("[data-chat-test-token-id='".concat(t.test_token_id,"']"))[0];var e=0!=$("#chat-list-".concat(t.test_token_id)).length;switch(t.type){case"new_message":e||($(this.tabTarget).addClass("new"),$("#chat-".concat(t.test_token_id)).addClass("new"),$("#chat-".concat(t.test_token_id)).find("h6.chat-list-item__last-message--data").html(t.message),$("#chat-".concat(t.test_token_id)).find("span.chat-list-item__last-message--time").html(t.time));break;case"clear_new_message":$(this.tabTarget).removeClass("new")}}connected(){}}a()(o,"targets",["tab"])},907:function(t,e,s){"use strict";s.r(e);var n=s(419),a=s(524);e.default=class extends n.b{connect(){console.log("connect ChatNotificationTestee ".concat(this.data.get("test-token-id"))),this.channel=a.a.subscriptions.create({channel:"ChatNotificationTesteeChannel",token:this.data.get("token"),time:(new Date).toString()},{connected:this.connected.bind(this),received:this.received.bind(this)})}disconnect(){this.channel.unsubscribe()}received(t){var e=0!=$("#chat-list-".concat(t.test_token_id)).length;switch(t.type){case"new_message":e||$.get({url:"/tests/".concat(t.test_id,"/chat_rooms/dialog")})}}connected(){}}},908:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return c}));var n=s(88),a=s.n(n),i=s(419);class c extends i.b{addChatRooms(t){t.preventDefault();let e=this.applicantsTarget.value,s=!0,n={};const a=/^(\d+)$/,i=/^(\d+)-(\d+)$/;if(a.test(e)){n={offset:e.match(a)[1],limit:1}}else if(i.test(e)){let t=e.match(i);t=t.map((t=>parseInt(t))).sort(((t,e)=>t-e)),s=t[1]<t[2],n={offset:t[1],limit:t[2]-t[1]+1}}else if(/^(\d+)(, ?\d+?)*$/.test(e)){let t=e.match(/\d+/g);t=t.map((t=>parseInt(t))).sort(((t,e)=>t-e)),n={offsets:t}}else s=!1;s&&$.ajax({type:"POST",url:$("#form-chat-add").attr("action"),data:n})}}a()(c,"targets",["applicants"])},909:function(t,e,s){"use strict";s.r(e);var n=s(419);e.default=class extends n.b{copy(){const t=$("<textarea></textarea>");$("body").append(t),t.val($("#js-content").val()).select(),document.execCommand("copy"),Hera.utils.snackbar(I18n.t("copied")),t.remove()}}},910:function(t,e,s){"use strict";s.r(e);var n=s(88),a=s.n(n),i=s(419),c=s(29),o=s.n(c);e.default=class extends i.b{constructor(...t){super(...t),a()(this,"phoneRegex",/\d{2,3}-\d{3,4}-\d{4}/),a()(this,"onKeyup",o.a.debounce(this._handleKeyup,500))}connect(){const t=document.getElementById("inquiry-terms");this._handleSubmitButton(!t.checked)}onChangeInquiryTerm(t){this._handleSubmitButton(!t.target.checked)}_handleSubmitButton(t){document.getElementById("inquiry-submit-button").disabled=t}_setError(t,e){const s=t.querySelector(".help-block");t.classList[e?"remove":"add"]("has-error"),s.classList[e?"add":"remove"]("hidden")}_handleKeyup(t){const{value:e,name:s}=t.target;this._setError(t.target.closest(".form-group"),"inquiry[email]"===s?Hera.commons.validateEmail(e):this.phoneRegex.test(e))}}}},[[1267,41,0,44]]]);
//# sourceMappingURL=application-faffd84199c501006598.chunk.js.map